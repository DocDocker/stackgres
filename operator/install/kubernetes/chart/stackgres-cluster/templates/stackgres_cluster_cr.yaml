{{ if .Values.cluster.create }}
apiVersion: stackgres.io/{{ .Values.crd.version }}
kind: StackGresCluster
metadata:
  name: {{ .Values.cluster.name }}
spec:
  instances: {{ .Values.cluster.instances }}
  pg_version: {{ .Values.config.postgresql.version }}
  pg_config: {{ .Values.cluster.pgconfig }}
  pgbouncer_config: {{ .Values.cluster.pgbouncerconfig }}
  resource_profile: {{ .Values.cluster.profile }}
  sidecars:
  {{- if .Values.sidecar.pooling }}
  - pgbouncer
  {{ end }}
  {{- if .Values.sidecar.utils }}
  - postgres-utils
  {{- end }}
{{ end }}
